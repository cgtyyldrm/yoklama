<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã–ÄŸretmen Paneli - QR Yoklama</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- QRCode.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- SheetJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <!-- LOGIN MODAL -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h2>GiriÅŸ Yap</h2>
            <p>Ã–ÄŸretmen paneline eriÅŸmek iÃ§in bilgilerinizi girin.</p>
            <form id="loginForm" autocomplete="on">
                <div class="input-group">
                    <label>E-posta Adresi</label>
                    <input type="email" id="emailInput" required placeholder="ornek@okul.com" autocomplete="username">
                </div>
                <div class="input-group">
                    <label>Åžifre</label>
                    <input type="password" id="passwordInput" required placeholder="******"
                        autocomplete="current-password">
                </div>
                <button type="submit" class="btn">GiriÅŸ</button>
            </form>
            <div id="loginError" class="error-message hidden">HatalÄ± bilgi!</div>
        </div>
    </div>

    <!-- MAIN DASHBOARD (Hidden by default) -->
    <div id="dashboard" class="container hidden" style="max-width: 800px;">
        <div class="header-row">
            <h1>Ã–ÄŸretmen Paneli</h1>
            <div style="display:flex; align-items:center; gap:10px;">
                <span id="teacherNameDisplay" style="color:var(--primary-color); font-weight:600;"></span>
                <button id="logoutBtn" class="btn-secondary" style="width:auto; padding: 8px 16px;">Ã‡Ä±kÄ±ÅŸ</button>
            </div>
        </div>

        <!-- TABS -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="courses">Derslerim</button>
            <button class="tab-btn" data-tab="create">Ders OluÅŸtur</button>
            <button class="tab-btn" data-tab="roster">Ã–ÄŸrenci Listesi</button>
            <button class="tab-btn" data-tab="settings">Ayarlar</button>
        </div>

        <!-- TAB CONTENT: COURSES -->
        <div id="coursesTab" class="tab-content active">
            <div id="loadingCourses" class="loading hidden">YÃ¼kleniyor...</div>
            <div id="coursesList" class="cards-grid">
                <!-- Course Cards will be injected here -->
            </div>

            <!-- Session View (Drill-down) -->
            <div id="sessionView" class="hidden">
                <button id="backToCourses" class="btn-secondary">&larr; Derslere DÃ¶n</button>
                <h2 id="currentCourseTitle" style="margin: 20px 0;">Matematik 101</h2>

                <div class="action-bar">
                    <button id="showQrBtn" class="btn" style="width: auto;">QR Kod GÃ¶ster</button>
                </div>
                <div id="courseQr" style="margin: 20px auto; display:none;"></div>

                <h3>HaftalÄ±k Program</h3>
                <div class="table-wrapper">
                    <table id="sessionsTable">
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>Durum</th>
                                <th>Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Sessions injected here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- TAB CONTENT: CREATE COURSE -->
        <div id="createTab" class="tab-content">
            <h2>Yeni Ders OluÅŸtur</h2>
            <form id="createCourseForm">
                <div class="input-group">
                    <label>Ders AdÄ±</label>
                    <input type="text" id="newCourseName" required placeholder="Ã–rn: Fizik 101">
                </div>
                <div class="row">
                    <div class="input-group">
                        <label>DÃ¶nem BaÅŸlangÄ±cÄ±</label>
                        <input type="date" id="termStart" required>
                    </div>
                    <div class="input-group">
                        <label>DÃ¶nem BitiÅŸi</label>
                        <input type="date" id="termEnd" required>
                    </div>
                </div>
                <div class="input-group">
                    <label>Ders GÃ¼nÃ¼</label>
                    <select id="classDay" required>
                        <option value="1">Pazartesi</option>
                        <option value="2">SalÄ±</option>
                        <option value="3">Ã‡arÅŸamba</option>
                        <option value="4">PerÅŸembe</option>
                        <option value="5">Cuma</option>
                        <option value="6">Cumartesi</option>
                        <option value="0">Pazar</option>
                    </select>
                </div>
                <button type="submit" class="btn">OluÅŸtur</button>
            </form>
            <div id="createStatus" class="hidden"></div>
        </div>

        <!-- TAB CONTENT: ROSTER -->
        <div id="rosterTab" class="tab-content">
            <h2>Ã–ÄŸrenci Listesi YÃ¼kle (Roster)</h2>
            <p>JSON formatÄ±nda Ã¶ÄŸrenci listesi yÃ¼kleyin veya manuel ekleyin.</p>
            <div class="input-group">
                <label>Ders SeÃ§in</label>
                <select id="rosterCourseSelect">
                    <option value="">YÃ¼kleniyor...</option>
                </select>
            </div>

            <div
                style="margin-bottom: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 12px; border: 1px solid var(--border-color);">
                <h3 style="margin-bottom:10px; font-size: 1rem;">Excel ile YÃ¼kle</h3>
                <div style="display:flex; gap:10px; margin-bottom: 10px;">
                    <button id="downloadTemplateBtn" class="btn-secondary" style="font-size: 0.9rem;">ðŸ“¥ Åžablon
                        Ä°ndir</button>
                    <input type="file" id="rosterFile" accept=".xlsx, .xls, .csv" style="display:none;">
                    <button id="selectFileBtn" class="btn-secondary" style="font-size: 0.9rem;">ðŸ“‚ Dosya SeÃ§</button>
                </div>
                <p id="fileNameDisplay" style="font-size: 0.8rem; margin-bottom:0;">Dosya seÃ§ilmedi</p>
            </div>

            <textarea id="rosterJson" rows="10" placeholder='[{"name": "Ali Veli", "number": "123"}, ...]'
                style="width:100%; padding: 10px; background: rgba(0,0,0,0.2); color: white; border: 1px solid var(--border-color); border-radius: 8px;"></textarea>
            <button id="uploadRosterBtn" class="btn" style="margin-top:10px;">Listeyi Kaydet</button>
            <div id="rosterStatus"></div>
        </div>

        <!-- TAB CONTENT: SETTINGS -->
        <div id="settingsTab" class="tab-content">
            <h2>Ayarlar</h2>
            <div class="input-group">
                <label>Google Apps Script URL</label>
                <input type="text" id="apiUrl" placeholder="https://script.google.com/...">
            </div>
            <button id="saveSettingsBtn" class="btn">Kaydet</button>
        </div>

    </div>

    <!-- ATTENDANCE MODAL -->
    <div id="attendanceModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h2 id="attModalTitle">Yoklama Listesi</h2>
                <button class="btn-xs danger" onclick="closeAttendanceModal()">Kapat</button>
            </div>

            <div id="attListLoading" class="loading hidden">YÃ¼kleniyor...</div>

            <div class="table-wrapper" style="max-height: 400px; overflow-y: auto;">
                <table id="attTable">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Ã–ÄŸrenci</th>
                            <th>Durum</th>
                        </tr>
                    </thead>
                    <tbody id="attTableBody">
                        <!-- Injected -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2025 Developed by <span style="color: var(--primary-color); font-weight: 600;">Ã‡aÄŸatay YILDIRIM</span>
            - TÃ¼m HaklarÄ± SaklÄ±dÄ±r.</p>
    </div>

    <script src="teacher.js"></script>
</body>

</html>